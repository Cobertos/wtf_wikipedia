!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).wtfImage=e()}(this,(function(){"use strict";var t={normalize:function(t=""){return t=(t=t.replace(/ /g,"_")).trim(),t=encodeURIComponent(t)},defaults:{lang:"en",path:"/w/api.php"},toUrlParams:function(t){return Object.entries(t).map(([t,e])=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&")}};const{normalize:e,defaults:n,toUrlParams:r}=t,o={action:"query",rdnamespace:0,prop:"redirects",rdlimit:500,format:"json",origin:"*",redirects:!0};var i=function(t,i){return i(function(t,n,i){let a=`https://${n.lang}.wikipedia.org/${n.path}?`;return n.domain&&(a=`https://${n.domain}/${n.path}?`),a+=r(o),a+="&titles="+e(t),i&&(a+="&rdcontinue="+i),a}(t.title(),n)).then(t=>{let e=Object.keys(t.query.pages||{});return 0===e.length?[]:t.query.pages[e[0]].redirects||[]})};const{normalize:a,defaults:u,toUrlParams:c}=t,s={action:"query",lhnamespace:0,prop:"linkshere",lhshow:"!redirect",lhlimit:500,format:"json",origin:"*",redirects:!0};var l=function(t,e){return e(function(t,e,n){let r=`https://${e.lang}.wikipedia.org/${e.path}?`;return e.domain&&(r=`https://${e.domain}/${e.path}?`),r+=c(s),r+="&titles="+a(t),n&&(r+="&lhcontinue="+n),r}(t.title(),u)).then(t=>{let e=Object.keys(t.query.pages||{});return 0===e.length?[]:t.query.pages[e[0]].linkshere||[]})};const{normalize:p,defaults:f,toUrlParams:h}=t,g={action:"query",prop:"pageviews",format:"json",origin:"*",redirects:!0};var d=function(t,e){return e(function(t,e,n){let r=`https://${e.lang}.wikipedia.org/${e.path}?`;return e.domain&&(r=`https://${e.domain}/${e.path}?`),r+=h(g),r+="&titles="+p(t),n&&(r+="&rdcontinue="+n),r}(t.title(),f)).then(t=>{let e=Object.keys(t.query.pages||{});return 0===e.length?[]:t.query.pages[e[0]].pageviews||[]})};const{normalize:m,defaults:y,toUrlParams:w}=t,$={action:"query",tinamespace:0,prop:"transcludedin",tilimit:500,format:"json",origin:"*",redirects:!0};var v=function(t,e,n){return n(function(t,e,n){let r=`https://${e.lang}.wikipedia.org/${e.path}?`;return e.domain&&(r=`https://${e.domain}/${e.path}?`),r+=w($),r+="&titles="+m(t),n&&(r+="&ticontinue="+n),r}(t,y)).then(t=>{let e=Object.keys(t.query.pages||{});return 0===e.length?[]:t.query.pages[e[0]].transcludedin||[]})},j=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return new Promise((function(r,o){if(t&&e)if(0!==t.length)for(var i=[],a=n-1,u=0,c=function n(c){u+=1;var s=e(t[c]);s.then?(s.then((function(t){i[c]=t})),s.catch((function(t){console.error(t),i[c]=null})),s.finally((function(){u-=1,a+=1,t.length>=a+1?n(a):u<=0&&r(i)}))):o("Error: function must return a promise")},s=t.length<n?t.length:n,l=0;l<s;l+=1)c(l);else r([]);else o("Error: missing required parameters to rate-limit function")}))},q={one:function(t,e){return j(t,e,1)},two:function(t,e){return j(t,e,2)},three:function(t,e){return j(t,e,3)},four:function(t,e){return j(t,e,4)},five:function(t,e){return j(t,e,5)},ten:function(t,e){return j(t,e,10)},fifteen:function(t,e){return j(t,e,15)}};q.serial=q.one,q.linear=q.one,q.crawl=q.three,q.walk=q.five,q.run=q.ten,q.sprint=q.fifteen;var k=q;var b,O=(b=Object.freeze({__proto__:null,default:k}))&&b.default||b;var P=function(t,e={},n){return t?n.category(t,e.lang).then(t=>{let r=function(t,e=5){let n=[];for(let r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}(t.pages.map(t=>t.title));return O.three(r,(function(t){return n.fetch(t,e)})).then(e=>({docs:[].concat.apply([],e),categories:t.categories}))}):{docs:[],categories:[]}};const{defaults:U,toUrlParams:z}=t,C={format:"json",action:"query",generator:"random",grnnamespace:14,prop:"revisions",grnlimit:1,origin:"*"};var I=function(t={},e){let n=`https://${(t=Object.assign({},U,t)).lang}.wikipedia.org/${t.path}?`;return t.domain&&(n=`https://${t.domain}/${t.path}?`),n+=z(C),e(n).then(t=>{try{let e=t.query.pages;return e[Object.keys(e)[0]].title}catch(t){throw t}}).catch(t=>(console.error(t),null))};var R=function(t,e,n){var r;t[0]&&((r=t[0])&&"[object Object]"===Object.prototype.toString.call(r))&&(t=t.map(t=>t.title));let o=function(t,e=5){let n=[];for(let r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}(t);return O.three(o,(function(t){return n.fetch(t,e)})).then(t=>t.reduce((t,e)=>t=t.concat(e)))};return function(t){t.Doc.prototype.getRedirects=function(){return i(this,t.http)},t.Doc.prototype.getIncoming=function(){return l(this,t.http)},t.Doc.prototype.getPageViews=function(){return d(this,t.http)},t.wtf.getRandomCategory=function(e){return I(e,t.http)},t.wtf.getTemplatePages=function(e,n){return v(e,n,t.http)},t.wtf.getCategoryPages=function(e,n){return P(e,n,t.wtf)},t.wtf.fetchList=function(e,n){return R(e,n,t.wtf)}}}));
