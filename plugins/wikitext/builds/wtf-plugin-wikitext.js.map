{"version":3,"file":"wtf-plugin-wikitext.js","sources":["../src/01-doc.js","../src/02-section.js","../src/03-paragraph.js","../src/_lib/smartReplace.js","../src/04-sentence.js","../src/05-link.js","../src/image.js","../src/infobox.js","../src/list.js","../src/reference.js","../src/table.js","../src/index.js"],"sourcesContent":["const defaults = {\r\n  images: true,\r\n  tables: true,\r\n  infoboxes: true,\r\n  categories: true,\r\n  lists: true,\r\n  links: true,\r\n  paragraphs: true\r\n}\r\nconst toWiki = function (options) {\r\n  options = options || {}\r\n  options = Object.assign({}, defaults, options)\r\n  let text = ''\r\n\r\n  //if it's a redirect page\r\n  if (this.isRedirect() === true) {\r\n    return `#REDIRECT [[${this.redirectTo().page}]]`\r\n  }\r\n\r\n  //render infoboxes (up at the top)\r\n  if (options.infoboxes === true) {\r\n    text += this.infoboxes()\r\n      .map((i) => i.wikitext(options))\r\n      .join('\\n')\r\n  }\r\n\r\n  //render each section\r\n  if (options.sections === true || options.paragraphs === true || options.sentences === true) {\r\n    let sections = this.sections()\r\n    // sections = sections.filter((s) => s.title() !== 'References')\r\n    text += sections.map((s) => s.wikitext(options)).join('\\n')\r\n  }\r\n\r\n  // add categories on the bottom\r\n  if (options.categories === true) {\r\n    text += '\\n'\r\n    this.categories().forEach((cat) => (text += `\\n[[Category: ${cat}]]`))\r\n  }\r\n  return text\r\n}\r\nmodule.exports = toWiki\r\n","const defaults = {}\r\n\r\nconst doTemplate = function (obj) {\r\n  let data = ''\r\n  let name = obj.template\r\n  Object.keys(obj).forEach((k) => {\r\n    if (k !== 'template') {\r\n      data += ` | ${k} = ${obj[k]}`\r\n    }\r\n  })\r\n  return `{{${name}${data}}} `\r\n}\r\n\r\nconst toWiki = function (options) {\r\n  options = options || {}\r\n  options = Object.assign({}, defaults, options)\r\n  let text = ''\r\n  if (this.title()) {\r\n    let side = '=='\r\n    text += `\\n${side} ${this.title()} ${side}\\n`\r\n  }\r\n  // render some templates?\r\n  this.templates().forEach((tmpl) => {\r\n    text += doTemplate(tmpl) + '\\n'\r\n  })\r\n\r\n  //make a table\r\n  if (options.tables === true) {\r\n    text += this.tables()\r\n      .map((t) => t.wikitext(options))\r\n      .join('\\n')\r\n  }\r\n\r\n  // make a html bullet-list\r\n  if (options.lists === true) {\r\n    text += this.lists()\r\n      .map((list) => list.text(options))\r\n      .join('\\n')\r\n  }\r\n  text += this.paragraphs()\r\n    .map((p) => {\r\n      return p.wikitext(options)\r\n    })\r\n    .join('\\n')\r\n\r\n  // render references\r\n  // these will be out of place\r\n  this.references().forEach((ref) => {\r\n    text += ref.wikitext(options) + '\\n'\r\n  })\r\n\r\n  return text\r\n}\r\nmodule.exports = toWiki\r\n","const defaults = {}\r\n\r\nconst toWiki = function (options) {\r\n  options = options || {}\r\n  options = Object.assign({}, defaults, options)\r\n  let text = ''\r\n\r\n  // do images\r\n  this.images().forEach((img) => {\r\n    text += img.wikitext()\r\n  })\r\n  // do lists\r\n  this.lists().forEach((list) => {\r\n    text += list.wikitext()\r\n  })\r\n  // render sentences\r\n  text += this.sentences()\r\n    .map((s) => {\r\n      return s.wikitext(options)\r\n    })\r\n    .join('\\n')\r\n  return text\r\n}\r\nmodule.exports = toWiki\r\n","//escape a string like 'fun*2.Co' for a regExpr\r\nfunction escapeRegExp(string) {\r\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') // $& means the whole matched string\r\n}\r\n\r\n//sometimes text-replacements can be ambiguous - words used multiple times..\r\nconst smartReplace = function(all, text, result) {\r\n  if (!text || !all) {\r\n    return all\r\n  }\r\n\r\n  if (typeof all === 'number') {\r\n    all = String(all)\r\n  }\r\n  text = escapeRegExp(text)\r\n  //try a word-boundary replace\r\n  let reg = new RegExp('\\\\b' + text + '\\\\b')\r\n  if (reg.test(all) === true) {\r\n    all = all.replace(reg, result)\r\n  } else {\r\n    //otherwise, fall-back to a much messier, dangerous replacement\r\n    // console.warn('missing \\'' + text + '\\'');\r\n    all = all.replace(text, result)\r\n  }\r\n  return all\r\n}\r\n\r\nmodule.exports = smartReplace\r\n","const smartReplace = require('./_lib/smartReplace')\r\n\r\nconst defaults = {\r\n  links: true\r\n}\r\n\r\nconst toWiki = function (options) {\r\n  options = options || {}\r\n  options = Object.assign({}, defaults, options)\r\n  let text = this.text()\r\n  if (options.links === true) {\r\n    this.links().forEach((link) => {\r\n      let str = link.text() || link.page()\r\n      let tag = link.wikitext()\r\n      text = smartReplace(text, str, tag)\r\n    })\r\n  }\r\n  if (options.formatting === true) {\r\n    //support bolds\r\n    this.bold().forEach((str) => {\r\n      let tag = '**' + str + '**'\r\n      text = smartReplace(text, str, tag)\r\n    })\r\n    //do italics\r\n    this.italic().forEach((str) => {\r\n      let tag = '***' + str + '***'\r\n      text = smartReplace(text, str, tag)\r\n    })\r\n  }\r\n\r\n  return text\r\n}\r\nmodule.exports = toWiki\r\n","// add `[text](href)` to the text\r\nconst toWiki = function() {\r\n  //if it's an external link, we good\r\n  if (this.site()) {\r\n    if (this.text()) {\r\n      return `[${this.site()}|${this.text()}]`\r\n    }\r\n    return `[${this.site()}]`\r\n  }\r\n  let page = this.page() || ''\r\n  if (this.anchor()) {\r\n    page += `#${this.anchor()}`\r\n  }\r\n\r\n  let str = this.text() || ''\r\n  if (str && str.toLowerCase() !== page.toLowerCase()) {\r\n    return `[[${page}|${str}]]`\r\n  }\r\n  return `[[${page}]]`\r\n}\r\nmodule.exports = toWiki\r\n","const toWiki = function () {\r\n  let text = `[[${this.file()}|thumb`\r\n  let caption = this.data.caption\r\n  if (caption) {\r\n    text += `|${this.data.caption.wikitext()}`\r\n  }\r\n  return text + ']]'\r\n}\r\nmodule.exports = toWiki\r\n","const toWiki = function() {\r\n  let text = `{{Infobox ${this._type || ''}\\n`\r\n  Object.keys(this.data).forEach(k => {\r\n    let val = this.data[k]\r\n    if (val) {\r\n      text += `| ${k} = ${val.wikitext() || ''}\\n`\r\n    }\r\n  })\r\n  text += '}}\\n'\r\n  return text\r\n}\r\nmodule.exports = toWiki\r\n","const toWiki = function() {\r\n  let txt = ''\r\n  this.lines().forEach(s => {\r\n    txt += `* ${s.wikitext()}\\n`\r\n  })\r\n  return txt\r\n}\r\nmodule.exports = toWiki\r\n","const toWiki = function () {\r\n  if (this.data.inline) {\r\n    return `<ref>${this.data.inline.wikitext()}</ref>`\r\n  }\r\n  let type = this.data.type || 'cite web'\r\n  let data = ''\r\n  Object.keys(this.data).forEach((k) => {\r\n    if (k !== 'template' && k !== 'type') {\r\n      data += ` | ${k} = ${this.data[k]}`\r\n    }\r\n  })\r\n  return `<ref>{{${type}${data}}}</ref>`\r\n}\r\nmodule.exports = toWiki\r\n","const toWiki = function (options) {\r\n  let rows = this.data\r\n  let wiki = `{| class=\"wikitable\"\\n`\r\n\r\n  // draw headers\r\n  let headers = Object.keys(rows[0])\r\n  headers = headers.filter((k) => /^col[0-9]/.test(k) !== true)\r\n  if (headers.length > 0) {\r\n    wiki += '|-\\n'\r\n    headers.forEach((k) => {\r\n      wiki += '! ' + k + '\\n'\r\n    })\r\n  }\r\n  //make rows\r\n  rows.forEach((o) => {\r\n    wiki += '|-\\n'\r\n    Object.keys(o).forEach((k) => {\r\n      let val = o[k].wikitext(options)\r\n      wiki += '| ' + val + '\\n'\r\n    })\r\n  })\r\n  wiki += `|}`\r\n  return wiki\r\n}\r\nmodule.exports = toWiki\r\n","const doc = require('./01-doc')\r\nconst section = require('./02-section')\r\nconst paragraph = require('./03-paragraph')\r\nconst sentence = require('./04-sentence')\r\nconst link = require('./05-link')\r\nconst image = require('./image')\r\nconst infobox = require('./infobox')\r\nconst list = require('./list')\r\nconst reference = require('./reference')\r\nconst table = require('./table')\r\n\r\nconst plugin = function(models) {\r\n  models.Doc.prototype.wikitext = doc\r\n  models.Section.prototype.wikitext = section\r\n  models.Paragraph.prototype.wikitext = paragraph\r\n  models.Sentence.prototype.wikitext = sentence\r\n  models.Link.prototype.wikitext = link\r\n  models.Image.prototype.wikitext = image\r\n  models.Infobox.prototype.wikitext = infobox\r\n  models.Table.prototype.wikitext = table\r\n  models.List.prototype.wikitext = list\r\n  models.Reference.prototype.wikitext = reference\r\n}\r\nmodule.exports = plugin\r\n"],"names":["defaults","images","tables","infoboxes","categories","lists","links","paragraphs","toWiki","options","Object","assign","text","isRedirect","redirectTo","page","map","i","wikitext","join","sections","sentences","s","forEach","cat","doTemplate","obj","data","name","template","keys","k","title","side","templates","tmpl","t","list","p","references","ref","img","escapeRegExp","string","replace","smartReplace","all","result","String","reg","RegExp","test","link","str","tag","formatting","bold","italic","site","anchor","toLowerCase","file","caption","_type","val","txt","lines","inline","type","rows","wiki","headers","filter","length","o","plugin","models","Doc","prototype","doc","Section","section","Paragraph","paragraph","Sentence","sentence","Link","Image","image","Infobox","infobox","Table","table","List","Reference","reference"],"mappings":"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"}